jQuery.noConflict();jQuery(document).ready(function(e){var b=e("div.simplegallery");var d=b.size();for(i=0;i<d;i++){a(e(b[i]).attr("id"))}function a(w){var y="#"+w;var o=0;var g=e(y+" .thumbnails dt a");var q=e(y+" .thumbnails");var v=e(y+" .largeimage");var f=e(v).children("a").children("img");var A=e(v).children("h3");var n=g.size();var x=g[o];e(g).attr("class","");debug(y+": thumbnail classes removed");e(v).children("a").attr("class","");debug(y+": large image classes removed: "+e(v).children("a").attr("class"));function p(C){debug(y+": img showImg() called for thumbnail <a> with href "+e(C).attr("href"));if(e(C).attr("href")==e(f).attr("src")){return}if(gallerySettings[w]["fade"]=="out-in"||gallerySettings[w]["fade"]=="over"){e(f).hide();e(v).addClass("loading")}e(f).attr("src",e(C).attr("href")).attr("title",e(C).attr("title")).attr("alt",e(C).attr("title"));var B=e.trim(e(C).parent().parent().children("dd").html());var D=null;e(A).html(B);e(f).parent().attr("href",e(C).attr("href"));if("object"==typeof shutterReloaded){e(f).parent().click(function(){shutterLinks.simpleviewer=null;shutterLinks.simpleviewer={link:e(C).attr("href"),num:-1,set:0,title:B};shutterReloaded.make("simpleviewer");e(window).attr("onresize","");return false})}e(g).removeClass("current");e(C).addClass("current");u()}e(g).click(function(){for(i=0;i<n;i++){if(g[i]==this){o=i;break}}p(e(this));return false});e(f).load(function(){debug(y+": img load() called for img "+e(this).attr("src"));var C=false;if(e.browser.msie&&e.browser.version.indexOf("6.0")==0){C=true}if(C){e(f).width("");e(f).height("");var F=e(f).attr("src");var E="width";var D=parseInt(e(f).width());var H=e(f).css("max-"+E);var G=parseInt(H)/parseInt(e(f).css("max-height"));var B=D/parseInt(e(f).height());debug(y+": "+F+": css ratio "+G+" img ratio "+B);if(parseInt(e(f).height())>D){E="height";D=parseInt(e(f).height());H=e(f).css("max-height")}debug(y+": "+F+": constraint is "+E);if(H!=""&&H.indexOf("px")>-1){H=parseInt(H);if(D>H){if(E=="height"){e(f).height(H)}else{if(E=="width"){e(f).width(H)}}debug(y+": "+F+": "+E+" of changed from "+D+" down to "+H)}else{debug(y+": "+F+": no need to shrink. "+E+" already "+D)}}}debug(y+": image W x H:  "+e(f).width()+" x "+e(f).height());if(gallerySettings[w]["fade"]=="out-in"||gallerySettings[w]["fade"]=="over"){e(f).fadeIn(gallerySettings[w]["fadespeed"],function(){e(v).removeClass("loading");l()})}});function l(){if(gallerySettings[w]["fade"]!="over"){return}debug(y+": set background image to "+e(f).attr("src"));e(v).css("background-image","url("+e(f).attr("src")+")")}function r(B){switch(B.keyCode){case 40:case 39:j();break;case 38:case 37:t();break}}function j(){if(s()){o++;p(g[o])}}function t(){if(k()){o--;p(g[o])}}function s(){return(o<n-1)}function k(){return(o>0)}function u(){if(k()){e(y+" .simplegalleryprev").addClass("enabled");e(y+" .simplegalleryprev").removeClass("disabled")}else{e(y+" .simplegalleryprev").addClass("disabled");e(y+" .simplegalleryprev").removeClass("enabled")}if(s()){e(y+" .simplegallerynext").addClass("enabled");e(y+" .simplegallerynext").removeClass("disabled")}else{e(y+" .simplegallerynext").addClass("disabled");e(y+" .simplegallerynext").removeClass("enabled")}e(y+" .simplegalleryimagenumber").html(o+1)}p(g[0]);e(y+" .simplegallerynavbar").append("<ul>");e(y+" .simplegallerynavbar ul").append('<li class="simplegalleryprev disabled"><a href="javascript:void();" title="Previous"><span>&larr;</span></a></li>').append('<li class="simplegalleryimagenumbers"><span class="simplegalleryimagenumber">1</span> / <span class="simplegallerytotalimages">'+n+"</span></li>").append('<li class="simplegallerynext enabled"><a href="javascript:void();" title="Next"><span>&rarr;</span></a></li>').append("</ul>");e(y+" .simplegalleryprev").click(function(){if(e(this).hasClass("disabled")){return false}t();return false});e(y+" .simplegallerynext").click(function(){if(e(this).hasClass("disabled")){return false}j();return false});if(e.browser.mozilla){e(document).keypress(r)}else{e(document).keydown(r)}if(gallerySettings[w]["thumbnailscroll"]==1){var h=e(q).find(".gallery dl.gallery-item"),z=0,m=e(q).find("div.gallerywrapper").width();totalWidth=0,scrollingIndexEnd=0;h.each(function(){totalWidth+=parseInt(e(this).outerWidth(true))});scrollingIndexEnd=totalWidth/m-1;if(scrollingIndexEnd<0){scrollingIndexEnd=0}e(q).find("div.gallerywrapper div.gallery").css("min-width",totalWidth+"px");e(q).find(".thumbnailscroll").height(e(q).height());if(scrollingIndexEnd>0){e(q).find(".thumbnailscroll.thumbnailscroll-prev").click(function(){if(z>0){z--;c(q,z,scrollingIndexEnd);h.animate({left:"+="+m+"px"},"slow")}});e(q).find(".thumbnailscroll.thumbnailscroll-next").click(function(){if(z<scrollingIndexEnd){z++;c(q,z,scrollingIndexEnd);h.animate({left:"-="+m+"px"},"slow")}})}c(q,z,scrollingIndexEnd)}}function c(g,f,h){if(f==0&&h>0){e(g).find(".thumbnailscroll.thumbnailscroll-prev").css("visibility","hidden");e(g).find(".thumbnailscroll.thumbnailscroll-next").css("visibility","visible")}else{if(f==0&&h==0){e(g).find(".thumbnailscroll.thumbnailscroll-prev").css("visibility","hidden");e(g).find(".thumbnailscroll.thumbnailscroll-next").css("visibility","hidden")}else{if(f>0&&f<h){e(g).find(".thumbnailscroll.thumbnailscroll-prev").css("visibility","visible");e(g).find(".thumbnailscroll.thumbnailscroll-next").css("visibility","visible")}else{if(f>0&&f>=h){e(g).find(".thumbnailscroll.thumbnailscroll-prev").css("visibility","visible");e(g).find(".thumbnailscroll.thumbnailscroll-next").css("visibility","hidden")}}}}}});function debug(a){if(window.console){console.log(a)}};